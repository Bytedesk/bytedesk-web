"use strict"; var bd_kfe_kefu = { created: function () { bd_kfe_data.adminUid = window.adminUid, bd_kfe_data.workGroupWid = window.workGroupWid, bd_kfe_data.subDomain = window.subDomain, bd_kfe_data.type = window.type, bd_kfe_data.agentUid = window.agentUid, bd_kfe_data.uid = localStorage.bd_kfe_uid, bd_kfe_data.username = localStorage.bd_kfe_username, bd_kfe_data.nickname = localStorage.bd_kfe_nickname, bd_kfe_data.password = bd_kfe_data.username }, mounted: function () { null !== bd_kfe_data.username && void 0 !== bd_kfe_data.username && "" !== bd_kfe_data.username ? bd_kfe_httpapi.login() : bd_kfe_httpapi.requestUsername() } }; !function () { $.support.cors = !0, String.prototype.startsWith || (String.prototype.startsWith = function (e, t) { return t = t || 0, this.indexOf(e, t) === t }), String.prototype.includes || (String.prototype.includes = function (e) { var t = !1; return -1 !== this.indexOf(e) && (t = !0), t }), $("input[id=imagefile]").change(function (e) { console.log("upload:", $(this).val(), $(this)); var t = new FormData; t.append("file_name", bd_kfe_utils.guid()), t.append("username", bd_kfe_data.username), t.append("file", $("input[id=imagefile]")[0].files[0]), t.append("client", bd_kfe_data.client), $.ajax({ url: bd_kfe_data.HTTP_HOST + "/visitor/api/upload/image", contentType: !1, cache: !1, processData: !1, mimeTypes: "multipart/form-data", type: "post", data: t, success: function (e) { console.log("upload response:", e.data); var t = e.data; bd_kfe_stompapi.sendImageMessage(t) }, error: function (e) { console.log(e) } }) }), $("input[id=filefile]").change(function (e) { console.log("upload file:", $(this).val(), $(this)); var t = new FormData; t.append("file_name", bd_kfe_utils.guid()), t.append("username", bd_kfe_data.username), t.append("file", $("input[id=filefile]")[0].files[0]), t.append("client", bd_kfe_data.client), $.ajax({ url: bd_kfe_data.HTTP_HOST + "/visitor/api/upload/file", contentType: !1, cache: !1, processData: !1, mimeTypes: "multipart/form-data", type: "post", data: t, success: function (e) { console.log("upload response:", e.data); var t = e.data; bd_kfe_stompapi.sendFileMessage(t) }, error: function (e) { console.log(e) } }) }), $("#byteDesk-start").click(function () { bd_kfe_utils.isMobile() ? (console.log("is mobile browser"), window.open(bd_kfe_data.URL_ROOT_PATH + "chat?sub=" + window.subDomain + "&uid=" + window.adminUid + "&wid=" + window.workGroupWid + "&type=" + window.type + "&aid=" + window.agentUid + "&ph=ph")) : (console.log("is pc browser"), document.getElementById("byteDesk-app-wrapper").style.display = "", document.getElementById("byteDesk-start").style.display = "none", 0 === bd_kfe_data.thread.id && bd_kfe_httpapi.requestThread()) }), $("#byteDesk-max").click(function () { window.open(bd_kfe_data.URL_ROOT_PATH + "chat?sub=" + window.subDomain + "&uid=" + window.adminUid + "&wid=" + window.workGroupWid + "&type=" + window.type + "&aid=" + window.agentUid + "&ph=ph") }), $("#byteDesk-minus").click(function () { document.getElementById("byteDesk-app-wrapper").style.display = "none", document.getElementById("byteDesk-start").style.display = "" }), $("#byteDesk-close").click(function () { document.getElementById("byteDesk-app-wrapper").style.display = "none", document.getElementById("byteDesk-start").style.display = "" }), $("#byteDesk-input-emoji").click(function () { bd_kfe_utils.switchEmotion() }), $("#byteDesk-jietu").click(function () { alert("直接使用QQ/微信截图，Ctrl+V粘贴到输入框，即可直接发送截图") }), $("#byteDesk-upload-image").click(function () { bd_kfe_utils.showUploadImageDialog() }), $("#byteDesk-upload-file").click(function () { bd_kfe_utils.showUploadFileDialog() }), $("#byteDesk-message-rate").click(function () { console.log("rate"), $("#byteDesk-rate").show(), $("#byteDesk-main").hide() }), $("#byteDesk-rate-close").click(function () { $("#byteDesk-rate").hide(), $("#byteDesk-main").show() }), $("#byteDesk-leave-close").click(function () { $("#byteDesk-leave").hide(), $("#byteDesk-main").show() }), $("#byteDesk-input-pc-send").click(function () { console.log("send text message"), bd_kfe_stompapi.sendTextMessage() }), $("#byteDesk-input-mobile-send-btn").click(function () { console.log("collect mobile"), bd_kfe_httpapi.sendMobile() }), bd_kfe_data.browserTitle = document.title, document.addEventListener("visibilitychange", function () { "hidden" === document.visibilityState ? bd_kfe_data.browserTabHidden = !0 : "visible" === document.visibilityState && (bd_kfe_data.browserTabHidden = !1, document.title = bd_kfe_data.browserTitle) }), document.getElementById("byteDesk-input-textarea").addEventListener("paste", function (e) { var t, i, a, d = e.clipboardData, n = 0; if (d) { if (!(t = d.items)) return; for (i = t[0], a = d.types || []; n < a.length; n++)if ("Files" === a[n]) { i = t[n]; break } i && "file" === i.kind && i.type.match(/^image\//i) && bd_kfe_utils.imgReader(i) } }), bd_kfe_kefu.created(), bd_kfe_kefu.mounted() }();